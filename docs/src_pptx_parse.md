# PowerPoint Parser

**Module:** `src.pptx_parse`  
**File:** `src/pptx_parse.py`

## Overview

PowerPoint to Slideshow Converter Module for Presentator

This module provides functionality to convert PowerPoint (.pptx) files into
Presentator's slideshow format. Uses python-pptx library for parsing PowerPoint
files and extracts text content, images, and formatting information to create
HTML-based slides compatible with the Presentator system.

Features:
- Text extraction with positioning and formatting preservation
- Image extraction and conversion
- Background color detection
- Slide layout analysis
- HTML generation for web display

## Functions

### clean_text(text)

Clean and normalize text content from PowerPoint slides.

Removes extra whitespace, normalizes line breaks, and filters out
control characters to ensure clean text content for HTML display.

Args:
    text (str): Raw text content from PowerPoint slide
    
Returns:
    str: Cleaned and normalized text content

### cleanup_presentation_files(presentation_name)

Remove all files associated with a presentation.

### convert_pptx_file_free(pptx_path, output_name=None)

Main entry point for converting PPTX files to Presentator format.

High-level function that handles the complete conversion workflow from
PowerPoint file to saved slideshow in the Presentator system.

Args:
    pptx_path (str or Path): Path to the PowerPoint file to convert
    output_name (str, optional): Name for the output slideshow
    
Returns:
    str or None: Path to the saved slideshow file if successful, None if failed
    
Note:
    This function handles all aspects of conversion including error handling,
    progress reporting, and file saving. It's the recommended entry point
    for PowerPoint conversion in the Presentator system.

### convert_pptx_to_slideshow_free(pptx_path, output_name=None)

Convert PowerPoint presentation to Presentator slideshow format.

Main conversion function that processes a PowerPoint file and converts
it to the Presentator slideshow format with HTML content and extracted images.

Args:
    pptx_path (str or Path): Path to the PowerPoint (.pptx) file
    output_name (str, optional): Name for the output slideshow. If not provided,
        uses the filename without extension
        
Returns:
    dict: Slideshow data dictionary containing:
        - name: Slideshow name
        - slides: List of slide dictionaries with HTML content
        - metadata: Additional information about the conversion
        
Raises:
    FileNotFoundError: If the PowerPoint file doesn't exist
    Exception: For various PowerPoint parsing or conversion errors

### extract_formatted_text(shape)

Extract text with formatting from a shape.

### extract_slide_background(slide)

Try to extract background color from slide.

### extract_slide_content(slide)

Extract text content from a PowerPoint slide with positioning and formatting.

Analyzes slide shapes to extract text content, preserving layout information
and basic formatting. Handles different shape types and text positioning.

Args:
    slide: PowerPoint slide object from python-pptx
    
Returns:
    list: List of content dictionaries containing:
        - text: Extracted text content
        - type: Content type ("text", "title", etc.)
        - position: Positioning information (top, left, width, height)
        - formatting: Text formatting attributes

### extract_slide_images(slide, presentation_name, output_dir, slide_num)

Extract all images from a slide.

### format_slide_html(content_parts, images)

Convert slide content to rich HTML format matching existing slideshows.

### format_text_emphasis(text)

Add basic text formatting like bold and italic.

### is_title_text(content_part, index)

Determine if text is likely a title.

### save_converted_slideshow_free(slideshow_data, filename=None)

Save converted slideshow to JSON file.

## Source File Statistics

- **Total Lines:** 506
- **Code Lines:** 340
- **Functions:** 12
- **Classes:** 0
- **File Size:** 19884 bytes


---
*Generated by Presentator documentation generator*
